<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Animation with Initialization Hour and Variable Selector</title>
    <style>
        body {
            display: flex;
            flex-direction: row;
            height: 100vh;
            background-color: #f0f0f0;
            margin: 0;
        }
        .left-panel {
            width: 200px;
            background-color: #d0d0d0;
            padding: 20px;
            box-shadow: 2px 0 5px rgba(0,0,0,0.1);
        }
        .right-panel {
            flex-grow: 1;
            padding: 20px;
        }
        iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
        .selector {
            display: flex;
            flex-direction: column;
            margin-bottom: 20px;
        }
        .selector label {
            font-size: 16px;
            margin-bottom: 10px;
        }
        .selector select {
            padding: 10px;
            font-size: 16px;
        }
        .title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 20px;
            text-align: center;
        }
    </style>
</head>
<body>

    <div class="left-panel">
        <div class="title">MEPS browser</div>
        <div class="selector">
            <label for="hourSelect">Hour</label>
            <select id="hourSelect" onchange="loadContent()">
                <option value="00">00</option>
                <option value="03">03</option>
                <option value="06">06</option>
                <option value="09">09</option>
                <option value="12">12</option>
                <option value="15">15</option>
                <option value="18">18</option>
                <option value="21">21</option>
            </select>
        </div>
        <div class="selector">
            <label for="variableSelect">Variable</label>
            <select id="variableSelect" onchange="loadContent()">
                <option value="PrecInst">PrecInst</option>
                <option value="PrecAcc">PrecAcc</option>
                <option value="PrecSolid">PrecSolid</option>
                <option value="PrecType">PrecType</option>
                <option value="T_2mC">T_2mC</option>
                <option value="T_2mCzoom">T_2mCzoom</option>
                <option value="WindSPEED">WindSPEED</option>
                <option value="CloudAmount">CloudAmount</option>
                <option value="CloudBase">CloudBase</option>
                <option value="CloudDepth">CloudDepth</option>
                <option value="CloudTop">CloudTop</option>
                <option value="Visibility">Visibility</option>
                <option value="Hail">Hail</option>
                <option value="Lightning">Lightning</option>
                <option value="MU-CAPE">MU-CAPE</option>
                <option value="MLH">MLH</option>
                <option value="IcingHeight">IcingHeight</option>
                <option value="MaxCAT">MaxCAT</option>
                <option value="MaxWind">MaxWind</option>
                <option value="Tinv">Tinv</option>
                <option value="Wmax">Wmax</option>
            </select>
        </div>
    </div>

    <div class="right-panel">
        <iframe id="animationFrame" src="about:blank"></iframe>
    </div>

    <script>
        function loadContent() {
            const hour = document.getElementById('hourSelect').value;
            const variable = document.getElementById('variableSelect').value;
            const baseURL = `https://fminwp.fmi.fi/Harmonie-pyth/weathermaps/${variable}_`;

            let content = `
                <!DOCTYPE html>
                <html lang="en">
                <head>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <title>Image Slider Animation</title>
                    <style>
                        body {
                            display: flex;
                            flex-direction: column;
                            align-items: center;
                            justify-content: center;
                            height: 100vh;
                            background-color: #f0f0f0;
                        }
                        .slider-container {
                            display: flex;
                            align-items: center;
                        }
                        #slider {
                            width: 300px;
                            margin: 10px;
                        }
                        img {
                            max-width: 100%;
                            height: auto;
                            display: none;
                        }
                        img.active {
                            display: block;
                        }
                    </style>
                </head>
                <body>
                    <div class="slider-container">
                        <button id="prevBtn">Previous</button>
                        <input type="range" id="slider" min="1" max="66" value="1">
                        <button id="nextBtn">Next</button>
                    </div>
                    <div id="image-container"></div>
                    <script>
                        (function() {
                            const imageContainer = document.getElementById('image-container');
                            const slider = document.getElementById('slider');
                            const prevBtn = document.getElementById('prevBtn');
                            const nextBtn = document.getElementById('nextBtn');

                            const baseURL = '${baseURL}';

                            for (let i = 1; i <= 66; i++) {
                                const img = document.createElement('img');
                                const imgNum = i.toString().padStart(2, '0');
                                img.id = \`image${hour}\${imgNum}\`;
                                img.src = \`\${baseURL}${hour}\${imgNum}.png\`;
                                img.alt = \`Image ${hour}\${imgNum}\`;
                                img.onload = () => console.log(\`Loaded \${img.src}\`);
                                img.onerror = () => console.error(\`Error loading \${img.src}\`);
                                if (i === 1) {
                                    img.classList.add('active');
                                }
                                imageContainer.appendChild(img);
                            }

                            slider.addEventListener('input', function() {
                                console.log(\`Slider value: \${this.value}\`);
                                updateImages(this.value);
                            });

                            prevBtn.addEventListener('click', function() {
                                if (slider.value > 1) {
                                    slider.value--;
                                    console.log(\`Slider value: \${slider.value}\`);
                                    updateImages(slider.value);
                                }
                            });

                            nextBtn.addEventListener('click', function() {
                                if (slider.value < 66) {
                                    slider.value++;
                                    console.log(\`Slider value: \${slider.value}\`);
                                    updateImages(slider.value);
                                }
                            });

                            function updateImages(value) {
                                const images = document.querySelectorAll('img');
                                console.log(\`Updating images to show image \${value}\`);
                                images.forEach((img, index) => {
                                    img.classList.remove('active');
                                    if (index + 1 == value) {
                                        img.classList.add('active');
                                    }
                                });
                            }
                        })();
                    <\/script>
                </body>
                </html>`;
                
            const frameDoc = document.getElementById('animationFrame').contentDocument || document.getElementById('animationFrame').contentWindow.document;
            frameDoc.open();
            frameDoc.write(content);
            frameDoc.close();
        }

        window.onload = function() {
            loadContent();
        }
    </script>
    
</body>
</html>

